{% extends "base.html" %}
{% block title %}Reduction Planner{% endblock %}
{% block content %}
<h1 class="page-title">Reduction Planner</h1>

<section class="card">
  <form id="planner-form">
    <label>LED retrofit coverage (% of facilities lighting)
      <input type="number" name="led_retrofit_pct" step="1" value="50">
    </label>
    <label>Solar share (% of annual kWh)
      <input type="number" name="solar_share_pct" step="1" value="25">
    </label>
    <label>Hybrid/EV fleet (% of vehicles)
      <input type="number" name="fleet_hybrid_pct" step="1" value="30">
    </label>
    <button type="submit">Evaluate plan</button>
  </form>
</section>

<section class="card">
  <h3>Estimated Impact</h3>
  <pre id="planner-out">Submit to see estimated reductionsâ€¦</pre>
</section>

<script>
(function () {
  const token = localStorage.getItem('token') || '';
  const form = document.getElementById('planner-form');
  const out = document.getElementById('planner-out');

  form.addEventListener('submit', async (e) => {
    e.preventDefault();

    // Planner settings are NOT part of backend yet,
    // so we simply fetch the impact report.
    const resp = await fetch('/api/planner/evaluate', {
      headers: { 'Authorization': 'Bearer ' + token }
    });

    out.textContent = resp.ok
      ? JSON.stringify(await resp.json(), null, 2)
      : 'Error ' + resp.status + ': ' + await resp.text();
  });
})();
</script>

{% endblock %}
